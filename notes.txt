2018-11-22
    start load_AHRI_directories.R to read AHRI directories into R
    
    did I accidentally down load the same records twice?
    no only downloads the first 250 records.
    
    redo search w/ Max GPM <= 5.0 , then Max GPM >= 5.1
    
    download the Energy Guide Label pdf files

2018-11-23
    get CEC directories
    https://cacertappliances.energy.ca.gov/Pages/Search/AdvancedSearch.aspx
    Select Appliance Type
        Select Category: Water Heater Products
        Select Appliance: Small Gas & Oil Water Htrs.
        Select Appliance Status: Approved
    Select Fields to Display
        Select All
        
    Search Results
    14985 record(s) found         
    Export To: /home/jiml/HotWaterResearch/projects/CECHWT24/2019 ACM tankless/CEC/2018-11-23 Small Gas & Oil Water Htrs.csv

    get DOE directories
    https://www.regulations.doe.gov/certification-data/CCMS-4-Water_Heaters.html#q=Product_Group_s%3A%22Water%20Heaters%22
    + More Options 
    Type of Heater: Instantaneous Gas-fired Water Heater
    650 Models
    Download
    /home/jiml/HotWaterResearch/projects/CECHWT24/2019 ACM tankless/DOE/Water_Heaters_2018-11-23_9-15-54.csv
    
    loading CEC directory, a lot of strange data 
    and UEF came through as logical even though specified col_type as double
    had to use guess_max as 15000 and not set col_type
    
    I was mistaken, should have used a "l" instead of a "|".
    
    plot of UEF vs RE looks reasonable
    
    loaded DOE directory UEF vs RE looks similar to the CEC one
    
    clean up CEC tankless directory names
    
    And here's what on the Energy Guide Label
        Max GPM
        GPM Rating {very small | low | medium | high}
        Estimated yearly energy use (in therms)
            Not clear whether this is total energy use or just the gas use.
        cost ( This is therms * $1.09/therm)

    translating energyguide.pl into .R to parse the Energy Guide labels with
    pdfimages, convert, tesseract 
    
    
    check AHRI data to see if Estimated yearly energy use from Energy Guide Label
    is equal to Uniform Energy Factor / Qout from test draw pattern
    that might show the difference of Annual Energy total vs fossil
    
2018-11-24
    got convert and tesseract to work
    better to convert them all to text files then use a different script to extract data.
        
    see http://www.mjdenny.com/Text_Processing_In_R.html
    and https://quanteda.io/articles/quickstart.html, this one is probably too elaborate
    
    These AHRIrefnums don't have Energy Guide Labels posted on the AHRI directory.
    202067561
    202067563
    202068374
    202068376
    202068377
    
    since the *.txt files are small, read them in as one long string into the data.table
    removed \n \r & \f first.

    need to parse out the brand, MaxGPM, model_num, and Eannual,f (if that's what it is)
    the files aren't completely consistent, so this may be messy.
    quicker and less messy inside data.table
    
    parsed into DT_EGL, seems to have worked OK.
    
    next group by manufacturer?
    then calculate Eannul,e from UEF based on bin
    
    calculate Eannual,e from
    
    Qin.UEF = Eannual,f * 100,000 + Eannual,e * 3412  
    
    Eannual,e = ((Qout.UEF / UEF) - (Eannual,f * 100,000)) / 3412  
    
    where,
    
    Eannual,f   is from the Energy Guide Labels
    Qin.UEF = Qout.UEF / UEF
    Qout is calculated from test procedure conditions and draw patterns
    ~/HotWaterResearch/projects/CECHWT24/2019 ACM tankless/Tankless WH consumption calculations for ACM.23.doc    
    
    then calculate the ratio of gas consumption to total energy consumption	
    
    F = 1 / { 1+ (Eannual,e / Eannual,f) * 3412 / 100,000 }
	
    and examine	F
    
    that didn't work. fossil and total were not measured indepently.
    it's way too linear of a fit.
    Eannul_F was not doubt calculated from UEF 
    
2018-11-26
    2 separate next steps - combine all the data.tables while 
    aligning the water heater models as much as possible. 
    determine duplicates to find basic models
    
    review algorithm to see what simplifications and assumptions are possible
    
    memo to CEC appliance standards on what fields should be in the directory when it gets revised
    
    another possible task is to examine technical specification sheets of common tankless WH 
    basic models to update information about electricity usage
    
    What about searching the internet for information on detailed monitoring of tankless WHS?
    Use this for updating default electricity estimation and TC
    
Haile, James, and Marc Hoeschele. “PG&E Residential Code Readiness Project: G. J. Gardner Site Monitoring Report.” Frontier Energy, Inc. for Pacific Gas and Electric Company Codes and Standards, August 21, 2018. https://www.etcc-ca.com/file/1806/download?token=acbnvKRt.

    they have monitored electricity on Domestic hot water is provided by a condensing natural gas tankless water heater Takagi (AT-H3S-OS-N) but not monitored gas use. Estimated monthly gas use by electicity use.
    
    Leni-Konig, Katrina, and Robert A. Davis. “Laboratory Testing of Residential Gas Water Heaters.” Emerging Technologies Program. San Ramon, CA: PG&E Applied Technology Services, December 2008. https://www.etcc-ca.com/file/1160/download?token=KY9Jd20Y.
tested Takagi T-H1 build date 10/27/2006
Average Measured Power Use Burner On (W) 60
Average Measured Power Use Idle (W) 6

https://www.etcc-ca.com/reports/residential-water-heating-program#
https://www.etcc-ca.com/reports/residential-feasibility-assessment-gas-tankless-water-heaters-pge-service-territory#
https://www.etcc-ca.com/reports/residential-feasibility-assessment-gas-tankless-water-heaters-pge-service-territory

2018-11-27
    for now merge directories then find basic models
    saved the names to columnar .csv file to examine how to merge.
    
    use openxlsx to save lists of names from each data.table to a different sheet in dirnames.xlsx

2018-11-28
    compare fields in different directories for basic models and harmonization?
    
    to identify basic models, group by UEF, RE, and MaxGPM
    do that for AHRI, DOE, and CEC directories,
    see how well DOE's Basic_Model_Number matches 
    compare results tri-axial plots?
    https://stackoverflow.com/questions/39124963/triaxial-ratio-diagrams-in-r-i-e-rotated-axes
    
    